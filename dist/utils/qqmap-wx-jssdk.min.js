"use strict";

var _createClass = function () {
  function a(e, c) {
    for (var b = 0; b < c.length; b++) {
      var d = c[b];d.enumerable = d.enumerable || false;d.configurable = true;if ("value" in d) {
        d.writable = true;
      }Object.defineProperty(e, d.key, d);
    }
  }return function (d, b, c) {
    if (b) {
      a(d.prototype, b);
    }if (c) {
      a(d, c);
    }return d;
  };
}();function _classCallCheck(a, b) {
  if (!(a instanceof b)) {
    throw new TypeError("Cannot call a class as a function");
  }
}var ERROR_CONF = { KEY_ERR: 311, KEY_ERR_MSG: "key格式错误", PARAM_ERR: 310, PARAM_ERR_MSG: "请求参数信息有误", SYSTEM_ERR: 600, SYSTEM_ERR_MSG: "系统错误", WX_ERR_CODE: 1000, WX_OK_CODE: 200 };var BASE_URL = "https://apis.map.qq.com/ws/";var URL_SEARCH = BASE_URL + "place/v1/search";var URL_SUGGESTION = BASE_URL + "place/v1/suggestion";var URL_GET_GEOCODER = BASE_URL + "geocoder/v1/";var URL_CITY_LIST = BASE_URL + "district/v1/list";var URL_AREA_LIST = BASE_URL + "district/v1/getchildren";var URL_DISTANCE = BASE_URL + "distance/v1/";var Utils = { location2query: function location2query(c) {
    if (typeof c == "string") {
      return c;
    }var b = "";for (var a = 0; a < c.length; a++) {
      var e = c[a];if (!!b) {
        b += ";";
      }if (e.location) {
        b = b + e.location.lat + "," + e.location.lng;
      }if (e.latitude && e.longitude) {
        b = b + e.latitude + "," + e.longitude;
      }
    }return b;
  }, getWXLocation: function getWXLocation(c, b, a) {
    wx.getLocation({ type: "gcj02", success: c, fail: b, complete: a });
  }, getLocationParam: function getLocationParam(b) {
    if (typeof b == "string") {
      var a = b.split(",");if (a.length === 2) {
        b = { latitude: b.split(",")[0], longitude: b.split(",")[1] };
      } else {
        b = {};
      }
    }return b;
  }, polyfillParam: function polyfillParam(a) {
    a.success = a.success || function () {};a.fail = a.fail || function () {};a.complete = a.complete || function () {};
  }, checkParamKeyEmpty: function checkParamKeyEmpty(c, b) {
    if (!c[b]) {
      var a = this.buildErrorConfig(ERROR_CONF.PARAM_ERR, ERROR_CONF.PARAM_ERR_MSG + b + "参数格式有误");c.fail(a);c.complete(a);return true;
    }return false;
  }, checkKeyword: function checkKeyword(a) {
    return !this.checkParamKeyEmpty(a, "keyword");
  }, checkLocation: function checkLocation(c) {
    var a = this.getLocationParam(c.location);if (!a || !a.latitude || !a.longitude) {
      var b = this.buildErrorConfig(ERROR_CONF.PARAM_ERR, ERROR_CONF.PARAM_ERR_MSG + " location参数格式有误");c.fail(b);c.complete(b);return false;
    }return true;
  }, buildErrorConfig: function buildErrorConfig(a, b) {
    return { status: a, message: b };
  }, buildWxRequestConfig: function buildWxRequestConfig(c, a) {
    var b = this;a.header = { "content-type": "application/json" };a.method = "GET";a.success = function (d) {
      var e = d.data;if (e.status === 0) {
        c.success(e);
      } else {
        c.fail(e);
      }
    };a.fail = function (d) {
      d.statusCode = ERROR_CONF.WX_ERR_CODE;c.fail(b.buildErrorConfig(ERROR_CONF.WX_ERR_CODE, result.errMsg));
    };a.complete = function (d) {
      var e = +d.statusCode;switch (e) {case ERROR_CONF.WX_ERR_CODE:
          c.complete(b.buildErrorConfig(ERROR_CONF.WX_ERR_CODE, d.errMsg));break;case ERROR_CONF.WX_OK_CODE:
          var f = d.data;if (f.status === 0) {
            c.complete(f);
          } else {
            c.complete(b.buildErrorConfig(f.status, f.message));
          }break;default:
          c.complete(b.buildErrorConfig(ERROR_CONF.SYSTEM_ERR, ERROR_CONF.SYSTEM_ERR_MSG));}
    };return a;
  }, locationProcess: function locationProcess(f, e, c, a) {
    var d = this;c = c || function (g) {
      g.statusCode = ERROR_CONF.WX_ERR_CODE;f.fail(d.buildErrorConfig(ERROR_CONF.WX_ERR_CODE, g.errMsg));
    };a = a || function (g) {
      if (g.statusCode == ERROR_CONF.WX_ERR_CODE) {
        f.complete(d.buildErrorConfig(ERROR_CONF.WX_ERR_CODE, g.errMsg));
      }
    };if (!f.location) {
      d.getWXLocation(e, c, a);
    } else {
      if (d.checkLocation(f)) {
        var b = Utils.getLocationParam(f.location);e(b);
      }
    }
  } };var QQMapWX = function () {
  function b(i) {
    _classCallCheck(this, b);if (!i.key) {
      throw Error("key值不能为空");
    }this.key = i.key;
  }_createClass(b, [{ key: "search", value: function f(i) {
      var l = this;i = i || {};Utils.polyfillParam(i);if (!Utils.checkKeyword(i)) {
        return;
      }var k = { keyword: i.keyword, orderby: i.orderby || "_distance", page_size: i.page_size || 10, page_index: i.page_index || 1, output: "json", key: l.key };if (i.address_format) {
        k.address_format = i.address_format;
      }if (i.filter) {
        k.filter = i.filter;
      }var n = i.distance || "1000";var j = i.auto_extend || 1;var m = function m(o) {
        k.boundary = "nearby(" + o.latitude + "," + o.longitude + "," + n + "," + j + ")";wx.request(Utils.buildWxRequestConfig(i, { url: URL_SEARCH, data: k }));
      };Utils.locationProcess(i, m);
    } }, { key: "getSuggestion", value: function h(i) {
      var k = this;i = i || {};Utils.polyfillParam(i);if (!Utils.checkKeyword(i)) {
        return;
      }var j = { keyword: i.keyword, region: i.region || "全国", region_fix: i.region_fix || 0, policy: i.policy || 0, output: "json", key: k.key };wx.request(Utils.buildWxRequestConfig(i, { url: URL_SUGGESTION, data: j }));
    } }, { key: "reverseGeocoder", value: function a(i) {
      var k = this;i = i || {};Utils.polyfillParam(i);var j = { coord_type: i.coord_type || 5, get_poi: i.get_poi || 0, output: "json", key: k.key };if (i.poi_options) {
        j.poi_options = i.poi_options;
      }var l = function l(m) {
        j.location = m.latitude + "," + m.longitude;wx.request(Utils.buildWxRequestConfig(i, { url: URL_GET_GEOCODER, data: j }));
      };Utils.locationProcess(i, l);
    } }, { key: "geocoder", value: function g(i) {
      var k = this;i = i || {};Utils.polyfillParam(i);if (Utils.checkParamKeyEmpty(i, "address")) {
        return;
      }var j = { address: i.address, output: "json", key: k.key };wx.request(Utils.buildWxRequestConfig(i, { url: URL_GET_GEOCODER, data: j }));
    } }, { key: "getCityList", value: function c(i) {
      var k = this;i = i || {};Utils.polyfillParam(i);var j = { output: "json", key: k.key };
      wx.request(Utils.buildWxRequestConfig(i, { url: URL_CITY_LIST, data: j }));
    } }, { key: "getDistrictByCityId", value: function d(i) {
      var k = this;i = i || {};Utils.polyfillParam(i);if (Utils.checkParamKeyEmpty(i, "id")) {
        return;
      }var j = { id: i.id || "", output: "json", key: k.key };wx.request(Utils.buildWxRequestConfig(i, { url: URL_AREA_LIST, data: j }));
    } }, { key: "calculateDistance", value: function e(i) {
      var k = this;i = i || {};Utils.polyfillParam(i);if (Utils.checkParamKeyEmpty(i, "to")) {
        return;
      }var j = { mode: i.mode || "walking", to: Utils.location2query(i.to), output: "json", key: k.key };var l = function l(m) {
        j.from = m.latitude + "," + m.longitude;wx.request(Utils.buildWxRequestConfig(i, { url: URL_DISTANCE, data: j }));
      };if (i.from) {
        i.location = i.from;
      }Utils.locationProcess(i, l);
    } }]);return b;
}();module.exports = QQMapWX;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInFxbWFwLXd4LWpzc2RrLm1pbi5qcyJdLCJuYW1lcyI6WyJfY3JlYXRlQ2xhc3MiLCJhIiwiZSIsImMiLCJiIiwibGVuZ3RoIiwiZCIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG90eXBlIiwiX2NsYXNzQ2FsbENoZWNrIiwiVHlwZUVycm9yIiwiRVJST1JfQ09ORiIsIktFWV9FUlIiLCJLRVlfRVJSX01TRyIsIlBBUkFNX0VSUiIsIlBBUkFNX0VSUl9NU0ciLCJTWVNURU1fRVJSIiwiU1lTVEVNX0VSUl9NU0ciLCJXWF9FUlJfQ09ERSIsIldYX09LX0NPREUiLCJCQVNFX1VSTCIsIlVSTF9TRUFSQ0giLCJVUkxfU1VHR0VTVElPTiIsIlVSTF9HRVRfR0VPQ09ERVIiLCJVUkxfQ0lUWV9MSVNUIiwiVVJMX0FSRUFfTElTVCIsIlVSTF9ESVNUQU5DRSIsIlV0aWxzIiwibG9jYXRpb24ycXVlcnkiLCJsb2NhdGlvbiIsImxhdCIsImxuZyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiZ2V0V1hMb2NhdGlvbiIsInd4IiwiZ2V0TG9jYXRpb24iLCJ0eXBlIiwic3VjY2VzcyIsImZhaWwiLCJjb21wbGV0ZSIsImdldExvY2F0aW9uUGFyYW0iLCJzcGxpdCIsInBvbHlmaWxsUGFyYW0iLCJjaGVja1BhcmFtS2V5RW1wdHkiLCJidWlsZEVycm9yQ29uZmlnIiwiY2hlY2tLZXl3b3JkIiwiY2hlY2tMb2NhdGlvbiIsInN0YXR1cyIsIm1lc3NhZ2UiLCJidWlsZFd4UmVxdWVzdENvbmZpZyIsImhlYWRlciIsIm1ldGhvZCIsImRhdGEiLCJzdGF0dXNDb2RlIiwicmVzdWx0IiwiZXJyTXNnIiwiZiIsImxvY2F0aW9uUHJvY2VzcyIsImciLCJRUU1hcFdYIiwiaSIsIkVycm9yIiwidmFsdWUiLCJsIiwiayIsImtleXdvcmQiLCJvcmRlcmJ5IiwicGFnZV9zaXplIiwicGFnZV9pbmRleCIsIm91dHB1dCIsImFkZHJlc3NfZm9ybWF0IiwiZmlsdGVyIiwibiIsImRpc3RhbmNlIiwiaiIsImF1dG9fZXh0ZW5kIiwibSIsIm8iLCJib3VuZGFyeSIsInJlcXVlc3QiLCJ1cmwiLCJoIiwicmVnaW9uIiwicmVnaW9uX2ZpeCIsInBvbGljeSIsImNvb3JkX3R5cGUiLCJnZXRfcG9pIiwicG9pX29wdGlvbnMiLCJhZGRyZXNzIiwiaWQiLCJtb2RlIiwidG8iLCJmcm9tIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxlQUFhLFlBQVU7QUFBQyxXQUFTQyxDQUFULENBQVdDLENBQVgsRUFBYUMsQ0FBYixFQUFlO0FBQUMsU0FBSSxJQUFJQyxJQUFFLENBQVYsRUFBWUEsSUFBRUQsRUFBRUUsTUFBaEIsRUFBdUJELEdBQXZCLEVBQTJCO0FBQUMsVUFBSUUsSUFBRUgsRUFBRUMsQ0FBRixDQUFOLENBQVdFLEVBQUVDLFVBQUYsR0FBYUQsRUFBRUMsVUFBRixJQUFjLEtBQTNCLENBQWlDRCxFQUFFRSxZQUFGLEdBQWUsSUFBZixDQUFvQixJQUFHLFdBQVdGLENBQWQsRUFBZ0I7QUFBQ0EsVUFBRUcsUUFBRixHQUFXLElBQVg7QUFBZ0IsY0FBT0MsY0FBUCxDQUFzQlIsQ0FBdEIsRUFBd0JJLEVBQUVLLEdBQTFCLEVBQThCTCxDQUE5QjtBQUFpQztBQUFDLFVBQU8sVUFBU0EsQ0FBVCxFQUFXRixDQUFYLEVBQWFELENBQWIsRUFBZTtBQUFDLFFBQUdDLENBQUgsRUFBSztBQUFDSCxRQUFFSyxFQUFFTSxTQUFKLEVBQWNSLENBQWQ7QUFBaUIsU0FBR0QsQ0FBSCxFQUFLO0FBQUNGLFFBQUVLLENBQUYsRUFBSUgsQ0FBSjtBQUFPLFlBQU9HLENBQVA7QUFBUyxHQUFwRTtBQUFxRSxDQUEvUCxFQUFqQixDQUFtUixTQUFTTyxlQUFULENBQXlCWixDQUF6QixFQUEyQkcsQ0FBM0IsRUFBNkI7QUFBQyxNQUFHLEVBQUVILGFBQWFHLENBQWYsQ0FBSCxFQUFxQjtBQUFDLFVBQU0sSUFB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O0FBQUMsVUFBSUksSUFBRSxJQUFOLENBQVdKLElBQUVBLEtBQUcsRUFBTCxDQUFRbEMsTUFBTWdCLGFBQU4sQ0FBb0JrQixDQUFwQixFQUF1QixJQUFHbEMsTUFBTWlCLGtCQUFOLENBQXlCaUIsQ0FBekIsRUFBMkIsSUFBM0IsQ0FBSCxFQUFvQztBQUFDO0FBQU8sV0FBSWMsSUFBRSxFQUFDZ0IsTUFBSzlCLEVBQUU4QixJQUFGLElBQVEsU0FBZCxFQUF3QkMsSUFBR2pFLE1BQU1DLGNBQU4sQ0FBcUJpQyxFQUFFK0IsRUFBdkIsQ0FBM0IsRUFBc0R0QixRQUFPLE1BQTdELEVBQW9FL0QsS0FBSTBELEVBQUUxRCxHQUExRSxFQUFOLENBQXFGLElBQUl5RCxJQUFFLFNBQVNBLENBQVQsQ0FBV2EsQ0FBWCxFQUFhO0FBQUNGLFVBQUVrQixJQUFGLEdBQU9oQixFQUFFN0MsUUFBRixHQUFXLEdBQVgsR0FBZTZDLEVBQUU1QyxTQUF4QixDQUFrQ0UsR0FBRzZDLE9BQUgsQ0FBV3JELE1BQU11QixvQkFBTixDQUEyQlcsQ0FBM0IsRUFBNkIsRUFBQ29CLEtBQUl2RCxZQUFMLEVBQWtCMkIsTUFBS3NCLENBQXZCLEVBQTdCLENBQVg7QUFBb0UsT0FBMUgsQ0FBMkgsSUFBR2QsRUFBRWdDLElBQUwsRUFBVTtBQUFDaEMsVUFBRWhDLFFBQUYsR0FBV2dDLEVBQUVnQyxJQUFiO0FBQWtCLGFBQU1uQyxlQUFOLENBQXNCRyxDQUF0QixFQUF3QkcsQ0FBeEI7QUFBMkIsS0FBM1ksRUFEdWlHLENBQWYsRUFDem9GLE9BQU9oRSxDQUFQO0FBQVMsQ0FENmhGLEVBQVosQ0FDOWdGOEYsT0FBT0MsT0FBUCxHQUFlbkMsT0FBZiIsImZpbGUiOiJxcW1hcC13eC1qc3Nkay5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2NyZWF0ZUNsYXNzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShlLGMpe2Zvcih2YXIgYj0wO2I8Yy5sZW5ndGg7YisrKXt2YXIgZD1jW2JdO2QuZW51bWVyYWJsZT1kLmVudW1lcmFibGV8fGZhbHNlO2QuY29uZmlndXJhYmxlPXRydWU7aWYoXCJ2YWx1ZVwiIGluIGQpe2Qud3JpdGFibGU9dHJ1ZX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxkLmtleSxkKX19cmV0dXJuIGZ1bmN0aW9uKGQsYixjKXtpZihiKXthKGQucHJvdG90eXBlLGIpfWlmKGMpe2EoZCxjKX1yZXR1cm4gZH19KCk7ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGEsYil7aWYoIShhIGluc3RhbmNlb2YgYikpe3Rocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9fXZhciBFUlJPUl9DT05GPXtLRVlfRVJSOjMxMSxLRVlfRVJSX01TRzpcImtleeagvOW8j+mUmeivr1wiLFBBUkFNX0VSUjozMTAsUEFSQU1fRVJSX01TRzpcIuivt+axguWPguaVsOS/oeaBr+acieivr1wiLFNZU1RFTV9FUlI6NjAwLFNZU1RFTV9FUlJfTVNHOlwi57O757uf6ZSZ6K+vXCIsV1hfRVJSX0NPREU6MTAwMCxXWF9PS19DT0RFOjIwMH07dmFyIEJBU0VfVVJMPVwiaHR0cHM6Ly9hcGlzLm1hcC5xcS5jb20vd3MvXCI7dmFyIFVSTF9TRUFSQ0g9QkFTRV9VUkwrXCJwbGFjZS92MS9zZWFyY2hcIjt2YXIgVVJMX1NVR0dFU1RJT049QkFTRV9VUkwrXCJwbGFjZS92MS9zdWdnZXN0aW9uXCI7dmFyIFVSTF9HRVRfR0VPQ09ERVI9QkFTRV9VUkwrXCJnZW9jb2Rlci92MS9cIjt2YXIgVVJMX0NJVFlfTElTVD1CQVNFX1VSTCtcImRpc3RyaWN0L3YxL2xpc3RcIjt2YXIgVVJMX0FSRUFfTElTVD1CQVNFX1VSTCtcImRpc3RyaWN0L3YxL2dldGNoaWxkcmVuXCI7dmFyIFVSTF9ESVNUQU5DRT1CQVNFX1VSTCtcImRpc3RhbmNlL3YxL1wiO3ZhciBVdGlscz17bG9jYXRpb24ycXVlcnk6ZnVuY3Rpb24gbG9jYXRpb24ycXVlcnkoYyl7aWYodHlwZW9mIGM9PVwic3RyaW5nXCIpe3JldHVybiBjfXZhciBiPVwiXCI7Zm9yKHZhciBhPTA7YTxjLmxlbmd0aDthKyspe3ZhciBlPWNbYV07aWYoISFiKXtiKz1cIjtcIn1pZihlLmxvY2F0aW9uKXtiPWIrZS5sb2NhdGlvbi5sYXQrXCIsXCIrZS5sb2NhdGlvbi5sbmd9aWYoZS5sYXRpdHVkZSYmZS5sb25naXR1ZGUpe2I9YitlLmxhdGl0dWRlK1wiLFwiK2UubG9uZ2l0dWRlfX1yZXR1cm4gYn0sZ2V0V1hMb2NhdGlvbjpmdW5jdGlvbiBnZXRXWExvY2F0aW9uKGMsYixhKXt3eC5nZXRMb2NhdGlvbih7dHlwZTpcImdjajAyXCIsc3VjY2VzczpjLGZhaWw6Yixjb21wbGV0ZTphfSl9LGdldExvY2F0aW9uUGFyYW06ZnVuY3Rpb24gZ2V0TG9jYXRpb25QYXJhbShiKXtpZih0eXBlb2YgYj09XCJzdHJpbmdcIil7dmFyIGE9Yi5zcGxpdChcIixcIik7aWYoYS5sZW5ndGg9PT0yKXtiPXtsYXRpdHVkZTpiLnNwbGl0KFwiLFwiKVswXSxsb25naXR1ZGU6Yi5zcGxpdChcIixcIilbMV19fWVsc2V7Yj17fX19cmV0dXJuIGJ9LHBvbHlmaWxsUGFyYW06ZnVuY3Rpb24gcG9seWZpbGxQYXJhbShhKXthLnN1Y2Nlc3M9YS5zdWNjZXNzfHxmdW5jdGlvbigpe307YS5mYWlsPWEuZmFpbHx8ZnVuY3Rpb24oKXt9O2EuY29tcGxldGU9YS5jb21wbGV0ZXx8ZnVuY3Rpb24oKXt9fSxjaGVja1BhcmFtS2V5RW1wdHk6ZnVuY3Rpb24gY2hlY2tQYXJhbUtleUVtcHR5KGMsYil7aWYoIWNbYl0pe3ZhciBhPXRoaXMuYnVpbGRFcnJvckNvbmZpZyhFUlJPUl9DT05GLlBBUkFNX0VSUixFUlJPUl9DT05GLlBBUkFNX0VSUl9NU0crYitcIuWPguaVsOagvOW8j+acieivr1wiKTtjLmZhaWwoYSk7Yy5jb21wbGV0ZShhKTtyZXR1cm4gdHJ1ZX1yZXR1cm4gZmFsc2V9LGNoZWNrS2V5d29yZDpmdW5jdGlvbiBjaGVja0tleXdvcmQoYSl7cmV0dXJuICF0aGlzLmNoZWNrUGFyYW1LZXlFbXB0eShhLFwia2V5d29yZFwiKX0sY2hlY2tMb2NhdGlvbjpmdW5jdGlvbiBjaGVja0xvY2F0aW9uKGMpe3ZhciBhPXRoaXMuZ2V0TG9jYXRpb25QYXJhbShjLmxvY2F0aW9uKTtpZighYXx8IWEubGF0aXR1ZGV8fCFhLmxvbmdpdHVkZSl7dmFyIGI9dGhpcy5idWlsZEVycm9yQ29uZmlnKEVSUk9SX0NPTkYuUEFSQU1fRVJSLEVSUk9SX0NPTkYuUEFSQU1fRVJSX01TRytcIiBsb2NhdGlvbuWPguaVsOagvOW8j+acieivr1wiKTtjLmZhaWwoYik7Yy5jb21wbGV0ZShiKTtyZXR1cm4gZmFsc2V9cmV0dXJuIHRydWV9LGJ1aWxkRXJyb3JDb25maWc6ZnVuY3Rpb24gYnVpbGRFcnJvckNvbmZpZyhhLGIpe3JldHVybntzdGF0dXM6YSxtZXNzYWdlOmJ9fSxidWlsZFd4UmVxdWVzdENvbmZpZzpmdW5jdGlvbiBidWlsZFd4UmVxdWVzdENvbmZpZyhjLGEpe3ZhciBiPXRoaXM7YS5oZWFkZXI9e1wiY29udGVudC10eXBlXCI6XCJhcHBsaWNhdGlvbi9qc29uXCJ9O2EubWV0aG9kPVwiR0VUXCI7YS5zdWNjZXNzPWZ1bmN0aW9uKGQpe3ZhciBlPWQuZGF0YTtpZihlLnN0YXR1cz09PTApe2Muc3VjY2VzcyhlKX1lbHNle2MuZmFpbChlKX19O2EuZmFpbD1mdW5jdGlvbihkKXtkLnN0YXR1c0NvZGU9RVJST1JfQ09ORi5XWF9FUlJfQ09ERTtjLmZhaWwoYi5idWlsZEVycm9yQ29uZmlnKEVSUk9SX0NPTkYuV1hfRVJSX0NPREUscmVzdWx0LmVyck1zZykpfTthLmNvbXBsZXRlPWZ1bmN0aW9uKGQpe3ZhciBlPStkLnN0YXR1c0NvZGU7c3dpdGNoKGUpe2Nhc2UgRVJST1JfQ09ORi5XWF9FUlJfQ09ERTpjLmNvbXBsZXRlKGIuYnVpbGRFcnJvckNvbmZpZyhFUlJPUl9DT05GLldYX0VSUl9DT0RFLGQuZXJyTXNnKSk7YnJlYWs7Y2FzZSBFUlJPUl9DT05GLldYX09LX0NPREU6dmFyIGY9ZC5kYXRhO2lmKGYuc3RhdHVzPT09MCl7Yy5jb21wbGV0ZShmKX1lbHNle2MuY29tcGxldGUoYi5idWlsZEVycm9yQ29uZmlnKGYuc3RhdHVzLGYubWVzc2FnZSkpfWJyZWFrO2RlZmF1bHQ6Yy5jb21wbGV0ZShiLmJ1aWxkRXJyb3JDb25maWcoRVJST1JfQ09ORi5TWVNURU1fRVJSLEVSUk9SX0NPTkYuU1lTVEVNX0VSUl9NU0cpKX19O3JldHVybiBhfSxsb2NhdGlvblByb2Nlc3M6ZnVuY3Rpb24gbG9jYXRpb25Qcm9jZXNzKGYsZSxjLGEpe3ZhciBkPXRoaXM7Yz1jfHxmdW5jdGlvbihnKXtnLnN0YXR1c0NvZGU9RVJST1JfQ09ORi5XWF9FUlJfQ09ERTtmLmZhaWwoZC5idWlsZEVycm9yQ29uZmlnKEVSUk9SX0NPTkYuV1hfRVJSX0NPREUsZy5lcnJNc2cpKX07YT1hfHxmdW5jdGlvbihnKXtpZihnLnN0YXR1c0NvZGU9PUVSUk9SX0NPTkYuV1hfRVJSX0NPREUpe2YuY29tcGxldGUoZC5idWlsZEVycm9yQ29uZmlnKEVSUk9SX0NPTkYuV1hfRVJSX0NPREUsZy5lcnJNc2cpKX19O2lmKCFmLmxvY2F0aW9uKXtkLmdldFdYTG9jYXRpb24oZSxjLGEpfWVsc2V7aWYoZC5jaGVja0xvY2F0aW9uKGYpKXt2YXIgYj1VdGlscy5nZXRMb2NhdGlvblBhcmFtKGYubG9jYXRpb24pO2UoYil9fX19O3ZhciBRUU1hcFdYPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihpKXtfY2xhc3NDYWxsQ2hlY2sodGhpcyxiKTtpZighaS5rZXkpe3Rocm93IEVycm9yKFwia2V55YC85LiN6IO95Li656m6XCIpfXRoaXMua2V5PWkua2V5fV9jcmVhdGVDbGFzcyhiLFt7a2V5Olwic2VhcmNoXCIsdmFsdWU6ZnVuY3Rpb24gZihpKXt2YXIgbD10aGlzO2k9aXx8e307VXRpbHMucG9seWZpbGxQYXJhbShpKTtpZighVXRpbHMuY2hlY2tLZXl3b3JkKGkpKXtyZXR1cm59dmFyIGs9e2tleXdvcmQ6aS5rZXl3b3JkLG9yZGVyYnk6aS5vcmRlcmJ5fHxcIl9kaXN0YW5jZVwiLHBhZ2Vfc2l6ZTppLnBhZ2Vfc2l6ZXx8MTAscGFnZV9pbmRleDppLnBhZ2VfaW5kZXh8fDEsb3V0cHV0OlwianNvblwiLGtleTpsLmtleX07aWYoaS5hZGRyZXNzX2Zvcm1hdCl7ay5hZGRyZXNzX2Zvcm1hdD1pLmFkZHJlc3NfZm9ybWF0fWlmKGkuZmlsdGVyKXtrLmZpbHRlcj1pLmZpbHRlcn12YXIgbj1pLmRpc3RhbmNlfHxcIjEwMDBcIjt2YXIgaj1pLmF1dG9fZXh0ZW5kfHwxO3ZhciBtPWZ1bmN0aW9uIG0obyl7ay5ib3VuZGFyeT1cIm5lYXJieShcIitvLmxhdGl0dWRlK1wiLFwiK28ubG9uZ2l0dWRlK1wiLFwiK24rXCIsXCIraitcIilcIjt3eC5yZXF1ZXN0KFV0aWxzLmJ1aWxkV3hSZXF1ZXN0Q29uZmlnKGkse3VybDpVUkxfU0VBUkNILGRhdGE6a30pKX07VXRpbHMubG9jYXRpb25Qcm9jZXNzKGksbSl9fSx7a2V5OlwiZ2V0U3VnZ2VzdGlvblwiLHZhbHVlOmZ1bmN0aW9uIGgoaSl7dmFyIGs9dGhpcztpPWl8fHt9O1V0aWxzLnBvbHlmaWxsUGFyYW0oaSk7aWYoIVV0aWxzLmNoZWNrS2V5d29yZChpKSl7cmV0dXJufXZhciBqPXtrZXl3b3JkOmkua2V5d29yZCxyZWdpb246aS5yZWdpb258fFwi5YWo5Zu9XCIscmVnaW9uX2ZpeDppLnJlZ2lvbl9maXh8fDAscG9saWN5OmkucG9saWN5fHwwLG91dHB1dDpcImpzb25cIixrZXk6ay5rZXl9O3d4LnJlcXVlc3QoVXRpbHMuYnVpbGRXeFJlcXVlc3RDb25maWcoaSx7dXJsOlVSTF9TVUdHRVNUSU9OLGRhdGE6an0pKX19LHtrZXk6XCJyZXZlcnNlR2VvY29kZXJcIix2YWx1ZTpmdW5jdGlvbiBhKGkpe3ZhciBrPXRoaXM7aT1pfHx7fTtVdGlscy5wb2x5ZmlsbFBhcmFtKGkpO3ZhciBqPXtjb29yZF90eXBlOmkuY29vcmRfdHlwZXx8NSxnZXRfcG9pOmkuZ2V0X3BvaXx8MCxvdXRwdXQ6XCJqc29uXCIsa2V5Omsua2V5fTtpZihpLnBvaV9vcHRpb25zKXtqLnBvaV9vcHRpb25zPWkucG9pX29wdGlvbnN9dmFyIGw9ZnVuY3Rpb24gbChtKXtqLmxvY2F0aW9uPW0ubGF0aXR1ZGUrXCIsXCIrbS5sb25naXR1ZGU7d3gucmVxdWVzdChVdGlscy5idWlsZFd4UmVxdWVzdENvbmZpZyhpLHt1cmw6VVJMX0dFVF9HRU9DT0RFUixkYXRhOmp9KSl9O1V0aWxzLmxvY2F0aW9uUHJvY2VzcyhpLGwpfX0se2tleTpcImdlb2NvZGVyXCIsdmFsdWU6ZnVuY3Rpb24gZyhpKXt2YXIgaz10aGlzO2k9aXx8e307VXRpbHMucG9seWZpbGxQYXJhbShpKTtpZihVdGlscy5jaGVja1BhcmFtS2V5RW1wdHkoaSxcImFkZHJlc3NcIikpe3JldHVybn12YXIgaj17YWRkcmVzczppLmFkZHJlc3Msb3V0cHV0OlwianNvblwiLGtleTprLmtleX07d3gucmVxdWVzdChVdGlscy5idWlsZFd4UmVxdWVzdENvbmZpZyhpLHt1cmw6VVJMX0dFVF9HRU9DT0RFUixkYXRhOmp9KSl9fSx7a2V5OlwiZ2V0Q2l0eUxpc3RcIix2YWx1ZTpmdW5jdGlvbiBjKGkpe3ZhciBrPXRoaXM7aT1pfHx7fTtVdGlscy5wb2x5ZmlsbFBhcmFtKGkpO3ZhciBqPXtvdXRwdXQ6XCJqc29uXCIsa2V5Omsua2V5fTtcclxud3gucmVxdWVzdChVdGlscy5idWlsZFd4UmVxdWVzdENvbmZpZyhpLHt1cmw6VVJMX0NJVFlfTElTVCxkYXRhOmp9KSl9fSx7a2V5OlwiZ2V0RGlzdHJpY3RCeUNpdHlJZFwiLHZhbHVlOmZ1bmN0aW9uIGQoaSl7dmFyIGs9dGhpcztpPWl8fHt9O1V0aWxzLnBvbHlmaWxsUGFyYW0oaSk7aWYoVXRpbHMuY2hlY2tQYXJhbUtleUVtcHR5KGksXCJpZFwiKSl7cmV0dXJufXZhciBqPXtpZDppLmlkfHxcIlwiLG91dHB1dDpcImpzb25cIixrZXk6ay5rZXl9O3d4LnJlcXVlc3QoVXRpbHMuYnVpbGRXeFJlcXVlc3RDb25maWcoaSx7dXJsOlVSTF9BUkVBX0xJU1QsZGF0YTpqfSkpfX0se2tleTpcImNhbGN1bGF0ZURpc3RhbmNlXCIsdmFsdWU6ZnVuY3Rpb24gZShpKXt2YXIgaz10aGlzO2k9aXx8e307VXRpbHMucG9seWZpbGxQYXJhbShpKTtpZihVdGlscy5jaGVja1BhcmFtS2V5RW1wdHkoaSxcInRvXCIpKXtyZXR1cm59dmFyIGo9e21vZGU6aS5tb2RlfHxcIndhbGtpbmdcIix0bzpVdGlscy5sb2NhdGlvbjJxdWVyeShpLnRvKSxvdXRwdXQ6XCJqc29uXCIsa2V5Omsua2V5fTt2YXIgbD1mdW5jdGlvbiBsKG0pe2ouZnJvbT1tLmxhdGl0dWRlK1wiLFwiK20ubG9uZ2l0dWRlO3d4LnJlcXVlc3QoVXRpbHMuYnVpbGRXeFJlcXVlc3RDb25maWcoaSx7dXJsOlVSTF9ESVNUQU5DRSxkYXRhOmp9KSl9O2lmKGkuZnJvbSl7aS5sb2NhdGlvbj1pLmZyb219VXRpbHMubG9jYXRpb25Qcm9jZXNzKGksbCl9fV0pO3JldHVybiBifSgpO21vZHVsZS5leHBvcnRzPVFRTWFwV1g7Il19